# 작업 결과

## 성공

- 로그인
- 로그아웃
- 게시글 작성
- 게시글 조회

## 실패

- 닉네임 수정 & 회원 탈퇴(삭제)
  - /members/{id}
  - 프론트가 id를 가지고 있다가 요청하는 것이 아니라
  - 헤더의 x-user-id를 확인해서 처리해야함
  - API 수정 필요
- 게시글 수정 & 게시글 삭제
  - 게시글 정보에 사용자 id(member id)가 없어서 누가 작성한 글인지 알수가 없음
- 게시글 조회
  - 게시글 조회 API 응답 데이터가 최신순이 아님
  - 페이징이 안되서 전체 데이터를 한번에 출력함

# 작업 기록

## 공통 사항

### Actions secrets and variables

- 시크릿 설정
    - JWT_SECRET_KEY
- 변수 설정
    - MMB_DOCKER_NETWORK : mmb-network
        - 모든 컨테이너는 하나의 네트워크로 통신할 수 있도록 설정

### 로그

- 전체적으로 로그가 너무 적음
    - 애플리케이션 동작 흐름을 추적하기가 어려움
- 로그 출력 방법도 모두 다 다름
    - 로그 설정 방법 통일 필요
- 컨테이너로 배포한 애플리케이션은 로그 관리 어떻게?
    - 파일로 써도 컨테이너 재시작하면 없어지 잖아?

> 로그 설정 및 관리 전략 필요

### 애플리케이션

- 컨테이너 포트 외부/내부 동일하게 설정되도록 수정
    - 외부 포트로 통신할떄도 있고 내부 포트로 할때도 있는데
    - 굳이 다르게 해서 설정 복잡하게 할 필요 없으니까

### 컨테이너

- 컨테이너 이름과 포트를 조직 레벨 변수로 설정할 필요 있음
- API GW에서 컨테이너 이름과 포트로 통신하기 때문에 모든 서비스가 같은 환경 변수를 사용하는 것이 관리에 좋아 보임

### 배포

- 도커 이미지 끝에 dev를 붙이는데 환경별로 자동으로 붙게 해야할 거 같다
    - 근데 dev/prod 처럼 관리하기도 하나?
    - 버전이랑 latest로 관리하는 거 아닌가?

> 도커 이미지 태그 설정 전략 필요

### 기타

- dev 쓰지 말고 develop
  - dev랑 develop을 혼용하니까 휴먼에러가 자주 발생
  - dev로 쓰고 있는 것도 develop으로 통일

## API GW

- 브랜치 이름 수정
    - dev -> develop
- .env.example -> .env
    - 어차피 로컬 전용이니까
- CORS 클래스 생성
- x-user-id 헤더 추가하는 코드 삽입
- front-end로 라우팅 할 필요 없음
  - 관련 설정 삭제함
- 라우팅 path 한줄로 써야하는 듯? OR 조건
- Host 설정하니까 로컬에서 라우팅이 안되서 일단 주석처리 원인 파악 필요
    - 로컬테스트 어떻게 했는지 의문....

## Auth

- 자동 배포 설정만 함
- 베타 버전 배포를 위해 특별히 수정할 부분 없었음
- 별개로
  - 액세스 토큰과 리프레시 토큰을 저장하고 발급받는 방법 협의가 필요함
  - 현재 프론트에서는 액세스 토큰을 리액트 변수(Redux)로 저장하고 있고
  - 리프레시 토큰은 브라우저 토큰으로 저장하는 것이 좋아보임
    - 이건 서버측에서 토큰으로 저장되도록 응답하는 것이 좋아보임

## Member

- DB
    - user, username 차이?
    - 네이버, 카카오 로그인 추가될 것을 고려해야 할듯
- GET /members/me
    - API 추가함
    - 헤더의 x-user-id 참조해서 조회
- /members/{id} 회원 정보 조회
    - 내가 아닌 다른 사람의 정보를 조회하는 일이 있을까?
    - 있다면 언제인지. 모든 정보를 다 보여줘도 되는지?
- /members/{id} 회원 정보 수정
    - 내가 아닌 다른 사람의 정보를 수정하는 일이 있을까?
    - 이건 없을 것 같은데...
    - PUT /members 로 바뀌어야 하지 않을까
    - 내부에서 x-user-id 참조해서
- /members/{id} 회원 정보 삭제
    - 내가 아닌 다른 사람의 정보 삭제?
    - 이건 본인만 가능해야 한다
    - DELETE /members로 바뀌어야 할듯
    - 역시 내부에서 x-user-id 참조해서
- cd-dev.yml 파일 다른 서비스들과 같은 형태로 수정했음

## Question

- 조회 응답
  - 작성자 id (이름 말고, member id) 필요
    - 누구의 게시글인 지 모름
    - 이름은 겹칠 수 있음
  - 생성/수정 시간 응답 필요
    - 언제 생성되고 수정 됐는 지 모름
  - 최신순으로 응답 필요
- 답변(Answer)은 별도로 서비스로 분리하는 것이 좋아 보임 