![image](https://github.com/user-attachments/assets/093c4ff0-e0e9-4902-9a3e-73eb8329e42c)

이것저것 조사한.. 뽀꼬교 조사병단 벽 외 조사 기록

내일 조사 더 할 예정 ㄷㄷ

# 1. 각 서비스를 마이크로서비스로 독립적으로 배포하려면?
- 각 서비스는 별도의 DockerFile과 별도의 Docker-compose.yml 파일을 가집니다.
- 각 서비스 디렉토리에서 개별적으로 다음 명령으로 배포합니다.
  ```bash
  docker-compose -f service-a/docker-compose.yml up -d --build
  ```
- CI/CD에서는 Git 머지 트리거를 통해 특정 서비스만 빌드 & 배포 할 수 있게 작업합니다.

# 2. IntelliJ Docker Intergration 사용 방법
!도커 설치 되어 있어야 함
step1. Settings > Build, Execution, Deployment > Docker
step2. + 버튼을 눌러 Docker for Mac, Docker for Windows, TCP Socket 중 환경에 맞게 설정
step3. 설정 후 Services 탭에서 컨테이너 상태, 로그 실행 관리 가능
step4. 각 서비스의 Dockerfile이나 docker-compose.yml 을 우클릭하여 실행 가능

# 3. 각 서비스별 docker-compose.yml 이 갖춰야할 내용
```yaml
version: '3.8'

services:
  service-a:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    env_file:
      - .env
    networks:
      - shared-network

```
최소 구성 : 
- build : 서비스 디렉토리와 Dockerfile 경로
- ports : 외부 포트 매핑
- env_file : 환경 변수 관리
- networks : 네트워크 설정

# 4. 공통 docker-compose.yml 은?
전체 msa 아키텍처를 구성하기 위해 개별 서비스가 가지는 docker compose 항목 외에 필요한 항목을 포함합니다.

디렉토리 구조
```bash
/msa-root/
  docker-compose.yml         <-- 공통 리소스 정의
  /service-a/
    docker-compose.yml
  /service-b/
    docker-compose.yml

```

공통 리소스를 관리합니다.
- 머머 넣을지 생각 쩜 필요

# 5. 공통 docker-compose.yml 내용
```yaml
version: '3.8'

services:
  mmb-redis:
    image:  redis:latest
    ports:
      - 6379:6379

networks:
  shared-network:

```
각 서비스는 external_networks 설정으로 이 네트워크에 참여

# 6. 로컬에서 개발하는 마이크로서비스를 프로세스와 컨테이너로 띄울 때 둘다 아우르는 환경 변수 관리법
하나의 환경 변수 파일 또는 설정을 공유해서 둘다 같은 설정을 쓰게 만들어야 함
1. 로컬 레포에 있는 docker-compose.yml에 아래처럼 .env 파일을 불러오게 설정
```yaml
env_file:
  - .env
```
2. IntelliJ의 Run/Debug Configurations에 .env와 환경변수를 동일하게 입력
